#!/bin/bash
set -e

echo "CATTLE_KDM_BRANCH is set to: $CATTLE_KDM_BRANCH"

echo "DAPPER_HOST_ARCH = $DAPPER_HOST_ARCH "
echo "CATTLE_HELM_VERSION = $CATTLE_HELM_VERSION "
echo "CATTLE_MACHINE_VERSION = $CATTLE_MACHINE_VERSION "
echo "CATTLE_K3S_VERSION = $CATTLE_K3S_VERSION "
echo "CATTLE_K3S_VERSION_DOCKER = $CATTLE_K3S_VERSION_DOCKER "
echo "HELM_VERSION = $HELM_VERSION "
echo "KUSTOMIZE_VERSION = $KUSTOMIZE_VERSION "
echo "HELM_UNITTEST_VERSION = $HELM_UNITTEST_VERSION "
echo "K3D_VERSION = $K3D_VERSION "
echo "CATTLE_KDM_BRANCH = $CATTLE_KDM_BRANCH "
echo "CONTROLLER_GEN_VERSION = $CONTROLLER_GEN_VERSION "

mkdir -p bin dist
if [ -e ./scripts/$1 ]; then
    ./scripts/"$@"
else
    exec "$@"
fi

chown -R $DAPPER_UID:$DAPPER_GID .
